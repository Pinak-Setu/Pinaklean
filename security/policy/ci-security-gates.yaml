# Reference copy from user baseline
version: 2025-08-25
gates:
  - name: secrets
    enforcement: block
    sources: [gitleaks, trufflehog, github_push_protection]
    conditions:
      any_true: [has_secret == true]

  - name: sast_critical
    enforcement: block
    sources: [codeql, semgrep, sonar]
    conditions:
      all_true:
        - new_vulns.critical == 0

  - name: sca_kevs
    enforcement: block
    sources: [snyk, dependabot, mend]
    conditions:
      all_true:
        - new_vulns.kev == 0

  - name: iac_high
    enforcement: warn
    sources: [tfsec, checkov, terrascan]
    conditions:
      all_true:
        - new_findings.high <= 2

  - name: image_signing
    enforcement: block
    sources: [cosign, kyverno]
    conditions:
      all_true:
        - image.signature == "valid"
        - image.user != "root"
        - image.fs == "read-only"

  - name: runtime_baseline
    enforcement: warn
    sources: [falco, tetragon]
    conditions:
      all_true:
        - anomaly_score < 5

  - name: risk_epss
    enforcement: block
    sources: [sbom_tool, epss, kev]
    conditions:
      all_true:
        - new_vulns.public_asset == true ? epss_score < 0.70 : true
        - new_vulns.kev == 0

  - name: asvs_release_gate
    enforcement: block
    sources: [asvs_checks]
    conditions:
      all_true:
        - target_app.tier == "tier-0" ? asvs.level >= 2 : asvs.level >= 1
